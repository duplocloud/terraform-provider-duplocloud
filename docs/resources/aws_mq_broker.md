---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "duplocloud_aws_mq_broker Resource - terraform-provider-duplocloud"
subcategory: ""
description: |-
  duplocloud_aws_mq_broker manages Amazon MQ broker in Duplo.
---

# duplocloud_aws_mq_broker (Resource)

`duplocloud_aws_mq_broker` manages Amazon MQ broker in Duplo.

## Example Usage

```terraform
resource "duplocloud_tenant" "myapp" {
  account_name = "myapp"
  plan_id      = "default"
}

resource "duplocloud_aws_mq_broker" "example" {
  tenant_id                  = duplocloud_tenant.myapp.tenant_id
  engine_type                = "ACTIVEMQ"
  deployment_mode            = "SINGLE_INSTANCE"
  broker_storage_type        = "EBS"
  broker_name                = "example5"
  host_instance_type         = "mq.m5.large"
  engine_version             = "5.18"
  authentication_strategy    = "SIMPLE"
  auto_minor_version_upgrade = true
  data_replication_mode      = "NONE"
  publicly_accessible        = false
  security_groups            = ["sg-0aead878f4e404689"]
  subnet_ids                 = ["subnet-0c9a95f287b4fc38f"]
  logs {
    general = true
    audit   = false
  }
  user {
    user_name = "admin"
    password  = "q2eqsaxasd121312sQsdfweqw"
    groups    = ["admins"]
  }
  encryption_options {
    kms_key_id        = "arn:aws:kms:us-west-2:123456789012:key/abcd-1234"
    use_aws_owned_key = false
  }
  maintenance_window {
    time_of_day = "02:00"
    time_zone   = "UTC"
    day_of_week = "SUNDAY"
  }
  tags = {
    Environment = "dev"
    Owner       = "team"
  }
}



resource "duplocloud_aws_mq_broker" "example" {
  tenant_id                  = duplocloud_tenant.myapp.tenant_id
  engine_type                = "ACTIVEMQ"
  deployment_mode            = "SINGLE_INSTANCE"
  broker_storage_type        = "EBS"
  broker_name                = "example5"
  host_instance_type         = "mq.m5.large"
  engine_version             = "5.18"
  authentication_strategy    = "LDAP"
  auto_minor_version_upgrade = true
  data_replication_mode      = "NONE"
  publicly_accessible        = false
  security_groups            = ["sg-0aead878f4e404689"]
  subnet_ids                 = ["subnet-0c9a95f287b4fc38f"] //, "subnet-09252308e1a093bda"]
  logs {
    general = true
    audit   = false
  }
  user {
    user_name = "admin"
    password  = "q2eqsaxasd121312sQsdfweqw"
  }
  ldap_server_metadata {
    hosts                    = ["ldap.example.com"]
    role_base                = "ou=roles,dc=example,dc=com"
    role_name                = "role"
    role_search_matching     = "(member={0})"
    role_search_subtree      = true
    service_account_password = "ldap-password#"
    service_account_username = "cn=admin,dc=example,dc=com"
    user_base                = "ou=users,dc=example,dc=com"
    user_role_name           = "role"
    user_search_matching     = "(uid={0})"
    user_search_subtree      = true
  }
}


resource "duplocloud_aws_mq_broker" "example" {
  tenant_id                  = duplocloud_tenant.myapp.tenant_id
  engine_type                = "RABBITMQ"
  deployment_mode            = "SINGLE_INSTANCE"
  broker_storage_type        = "EBS"
  broker_name                = "example5"
  host_instance_type         = "mq.t3.micro"
  engine_version             = "3.13"
  authentication_strategy    = "SIMPLE"
  auto_minor_version_upgrade = true
  data_replication_mode      = "NONE"
  publicly_accessible        = false
  security_groups            = ["sg-0aead878f4e404689"]
  logs {
    general = false
  }
  user {
    user_name = "admin"
    password  = "q2eqsaxasd121312sQsdfweqw"
    groups    = ["admins"]
  }
}


resource "duplocloud_aws_mq_broker" "example" {
  tenant_id                  = duplocloud_tenant.myapp.tenant_id
  engine_type                = "RABBITMQ"
  deployment_mode            = "CLUSTER_MULTI_AZ"
  broker_storage_type        = "EBS"
  broker_name                = "example5"
  host_instance_type         = "mq.m7g.medium"
  engine_version             = "3.13"
  authentication_strategy    = "SIMPLE"
  auto_minor_version_upgrade = true
  data_replication_mode      = "NONE"
  publicly_accessible        = false
  security_groups            = ["sg-0aead878f4e404689"]
  logs {
    general = false
  }
  user {
    user_name = "admin"
    password  = "q2eqsaxasd121312sQsdfweqw"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `authentication_strategy` (String) The authentication strategy. Valid values: LDAP, SIMPLE., RABBITMQ only supports SIMPLE and its not updatable after creation of RABBITMQ.
- `auto_minor_version_upgrade` (Boolean) Enables automatic upgrades to new minor versions.
- `broker_name` (String) The name of the broker.
- `data_replication_mode` (String) Data replication mode. Valid values: CRDR, NONE.
- `engine_type` (String) The type of broker engine. Valid values: ACTIVEMQ, RABBITMQ.
- `engine_version` (String) The version of the broker engine.
- `host_instance_type` (String) The broker's instance type.
- `logs` (Block List, Min: 1, Max: 1) Logging options for the broker. (see [below for nested schema](#nestedblock--logs))
- `publicly_accessible` (Boolean) Whether the broker is publicly accessible.
- `security_groups` (List of String) List of security group IDs. SG cannot be updated after creation for RABBITMQ.
- `tenant_id` (String) The GUID of the tenant that the SQS queue will be created in.
- `user` (Block List, Min: 1) Set of users for the broker. User not updatable after creation for RABBITMQ. (see [below for nested schema](#nestedblock--user))

### Optional

- `broker_storage_type` (String) The storage type of the broker. Valid values: EBS, EFS.
- `configuration` (Block List, Max: 1) MQ configuration. (see [below for nested schema](#nestedblock--configuration))
- `data_replication_primary_broker_arn` (String) ARN of the primary broker for data replication. Required when data_replication_mode is CRDR.
- `deployment_mode` (String) The deployment mode of the broker. Valid values: ACTIVE_STANDBY_MULTI_AZ, CLUSTER_MULTI_AZ, SINGLE_INSTANCE.
- `encryption_options` (Block List, Max: 1) Encryption options for the broker. (see [below for nested schema](#nestedblock--encryption_options))
- `is_app_idempotent` (Boolean) If true, a UUID will be generated and set to creator_request_id.
- `ldap_server_metadata` (Block List, Max: 1) LDAP server metadata. Not applicable for RabbitMQ. (see [below for nested schema](#nestedblock--ldap_server_metadata))
- `maintenance_window` (Block List, Max: 1) Maintenance window start time. (see [below for nested schema](#nestedblock--maintenance_window))
- `subnet_ids` (List of String) List of subnet IDs.
- `tags` (Map of String) A map of tags to assign to the resource.
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))

### Read-Only

- `arn` (String)
- `broker_fullname` (String)
- `broker_id` (String)
- `creator_request_id` (String) A unique, case-sensitive identifier to ensure idempotency of the request.
- `id` (String) The ID of this resource.

<a id="nestedblock--logs"></a>
### Nested Schema for `logs`

Required:

- `general` (Boolean) Enable general logging.

Optional:

- `audit` (Boolean) Enable audit logging (not applicable for RabbitMQ).


<a id="nestedblock--user"></a>
### Nested Schema for `user`

Required:

- `password` (String, Sensitive) The password.
- `user_name` (String) The username.

Optional:

- `console_access` (Boolean) Defaults to `false`.
- `groups` (List of String) Groups to which the user belongs.
- `replication_user` (Boolean) Defaults to `false`.


<a id="nestedblock--configuration"></a>
### Nested Schema for `configuration`

Required:

- `id` (String) Configuration ID.
- `revision` (Number) Configuration revision.


<a id="nestedblock--encryption_options"></a>
### Nested Schema for `encryption_options`

Optional:

- `kms_key_id` (String) KMS Key ID for encryption.
- `use_aws_owned_key` (Boolean) Whether to use AWS owned key. Defaults to `true`.


<a id="nestedblock--ldap_server_metadata"></a>
### Nested Schema for `ldap_server_metadata`

Required:

- `hosts` (List of String) List of LDAP hosts.
- `role_base` (String) LDAP role base.
- `role_name` (String) LDAP role name.
- `role_search_matching` (String) LDAP role search matching.
- `role_search_subtree` (Boolean) LDAP role search subtree.
- `service_account_password` (String, Sensitive) LDAP service account password.
- `service_account_username` (String) LDAP service account username.
- `user_base` (String) LDAP user base.
- `user_role_name` (String) LDAP user role name.
- `user_search_matching` (String) LDAP user search matching.
- `user_search_subtree` (Boolean) LDAP user search subtree.


<a id="nestedblock--maintenance_window"></a>
### Nested Schema for `maintenance_window`

Required:

- `day_of_week` (String) Day of week for maintenance window.
- `time_of_day` (String) Time of day for maintenance window. 24 hours format
- `time_zone` (String) Time zone for maintenance window.


<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String)
- `delete` (String)
- `update` (String)

## Import

Import is supported using the following syntax:

```shell
# Example: Importing an existing AWS MQ broker
#  - *TENANT_ID* is the tenant GUID
#  - *SHORT_NAME* is the short name of the AWS load balancer
#
terraform import duplocloud_aws_mq_broker.mq *TENANT_ID*/*SHORT_NAME*
```
