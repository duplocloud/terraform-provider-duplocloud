---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "duplocloud_asg_profile Resource - terraform-provider-duplocloud"
subcategory: ""
description: |-
  duplocloud_asg_profile manages a ASG Profile in Duplo.
---

# duplocloud_asg_profile (Resource)

`duplocloud_asg_profile` manages a ASG Profile in Duplo.

## Example Usage

```terraform
resource "duplocloud_tenant" "duplo-app" {
  account_name = "duplo-app"
  plan_id      = "default"
}

#Deploy a ASG to be used with Duplo's native container agent
resource "duplocloud_asg_profile" "duplo-test-asg" {
  tenant_id          = duplocloud_tenant.duplo-app.tenant_id
  friendly_name      = "duplo-test-asg"
  instance_count     = 1
  min_instance_count = 1
  max_instance_count = 2

  image_id       = "ami-077e0e0754c311a47" # <== put the AWS duplo docker AMI ID here
  capacity       = "t2.small"
  agent_platform = 0 # Duplo native container agent
  zone           = 0 # Zone A
  user_account   = duplocloud_tenant.duplo-app.account_name

  metadata {
    key   = "OsDiskSize" # <== This is the size of the OS disk in GB
    value = "100"
  }

}


#Asg example to enable metrics
resource "duplocloud_asg_profile" "duplo-test-asg" {
  tenant_id          = duplocloud_tenant.duplo-app.tenant_id
  friendly_name      = "duplo-test-asg"
  instance_count     = 1
  min_instance_count = 1
  max_instance_count = 2

  image_id       = "ami-077e0e0754c311a47" # <== put the AWS duplo docker AMI ID here
  capacity       = "t2.small"
  agent_platform = 0 # Duplo native container agent
  zone           = 0 # Zone A
  user_account   = duplocloud_tenant.duplo-app.account_name

  metadata {
    key   = "OsDiskSize" # <== This is the size of the OS disk in GB
    value = "100"
  }
  enabled_metrics = ["GroupDesiredCapacity", "GroupInServiceInstances", "GroupPendingInstances", "GroupStandbyInstances"] #, "GroupTerminatingInstances", "GroupTotalInstances"]

}


#custom node label example
resource "duplocloud_asg_profile" "duplo-test-asg" {
  tenant_id          = duplocloud_tenant.duplo-app.tenant_id
  friendly_name      = "duplo-test-asg"
  instance_count     = 1
  min_instance_count = 1
  max_instance_count = 2

  image_id       = "ami-077e0e0754c311a47" # <== put the AWS duplo docker AMI ID here
  capacity       = "t2.small"
  agent_platform = 0 # Duplo native container agent
  zone           = 0 # Zone A
  user_account   = duplocloud_tenant.duplo-app.account_name

  metadata {
    key   = "OsDiskSize" # <== This is the size of the OS disk in GB
    value = "100"
  }

  custom_node_labels = {
    "key1" = "value1"
    "key2" = "value2"
  }

}


//example for taints

resource "duplocloud_asg_profile" "duplo-test-asg" {
  tenant_id          = duplocloud_tenant.duplo-app.tenant_id
  friendly_name      = "asgtaint"
  instance_count     = 1
  min_instance_count = 1
  max_instance_count = 2

  image_id       = "ami-id" # <== put the AWS duplo docker AMI ID here
  capacity       = "t2.small"
  agent_platform = 7 # Duplo native container agent
  zone           = 1 # Zone A
  user_account   = "oct15"

  taints {
    key    = "tk1"
    value  = "tv2"
    effect = "NoSchedule"
  }
}


#secondary volume example
resource "duplocloud_asg_profile" "duplo-test-asg" {
  tenant_id             = duplocloud_tenant.duplo-app.tenant_id
  friendly_name         = "duplo-test-asg"
  instance_count        = 1
  min_instance_count    = 1
  max_instance_count    = 1
  image_id              = "ami-077e0e0754c311a47" # <== put the AWS duplo docker AMI ID here
  capacity              = "t3a.small"
  agent_platform        = 7 # Duplo native container agent
  zone                  = 0 # Zone A
  user_account          = duplocloud_tenant.duplo-app.account_name
  keypair_type          = 2
  prepend_user_data     = false
  use_spot_instances    = true
  can_scale_from_zero   = false
  is_cluster_autoscaled = false

  metadata {
    key   = "OsDiskSize" # <== This is the size of the OS disk in GB
    value = "100"
  }

  minion_tags {
    key   = "AllocationTags"
    value = "test"
  }

  volume {
    name        = "/dev/sda2"
    volume_type = "gp3"
    size        = 100
  }
}


resource "duplocloud_asg_profile" "duplo-test-asg" {
  tenant_id          = duplocloud_tenant.duplo-app.tenant_id
  friendly_name      = "duplo-test-asg"
  instance_count     = 1
  min_instance_count = 1
  max_instance_count = 2

  image_id       = "ami-077e0e0754c311a47" # <== put the AWS duplo docker AMI ID here
  capacity       = "t2.small"
  agent_platform = 0      # Duplo native container agent
  zones          = [0, 1] # [Zone A, Zone B]
  user_account   = duplocloud_tenant.duplo-app.account_name

  metadata {
    key   = "OsDiskSize" # <== This is the size of the OS disk in GB
    value = "100"
  }

}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `capacity` (String) The AWS EC2 instance type.
- `friendly_name` (String) The short name of the host.
- `image_id` (String) The AMI ID to use.
- `tenant_id` (String) The GUID of the tenant that the host will be created in.

### Optional

- `agent_platform` (Number) The numeric ID of the container agent pool that this host is added to. Defaults to `0`.
- `allocated_public_ip` (Boolean) Whether or not to allocate a public IP. Defaults to `false`.
- `base64_user_data` (String) Base64 encoded EC2 user data to associated with the host.
- `can_scale_from_zero` (Boolean) Whether or not ASG should leverage duplocloud's scale from 0 feature
- `cloud` (Number) The numeric ID of the cloud provider to launch the host in. Defaults to `0`.
- `custom_node_labels` (Map of String) Specify the labels to attach to the nodes.
- `enabled_metrics` (List of String) List of metrics to collect for the ASG Specify one or more of the following metrics.`GroupMinSize`,`GroupMaxSize`,`GroupDesiredCapacity`,`GroupInServiceInstances`,`GroupPendingInstances`,`GroupStandbyInstances`,`GroupTerminatingInstances`,`GroupTotalInstances`,`GroupInServiceCapacity`,`GroupPendingCapacity`,`GroupStandbyCapacity`,`GroupTerminatingCapacity`,`GroupTotalCapacity`,`WarmPoolDesiredCapacity`,`WarmPoolWarmedCapacity`,`WarmPoolPendingCapacity`,`WarmPoolTerminatingCapacity`,`WarmPoolTotalCapacity`,`GroupAndWarmPoolDesiredCapacity`,`GroupAndWarmPoolTotalCapacity`.
- `encrypt_disk` (Boolean) Defaults to `false`.
- `instance_count` (Number) The number of instances that should be running in the group.
- `is_cluster_autoscaled` (Boolean) Whether or not to enable cluster autoscaler.
- `is_ebs_optimized` (Boolean) Defaults to `false`.
- `is_minion` (Boolean) Defaults to `true`.
- `keypair_type` (Number) The numeric ID of the keypair type being used.Should be one of:

   - `0` : Default
   - `1` : ED25519
   - `2` : RSA (deprecated - some operating systems no longer support it)
- `max_instance_count` (Number) The maximum size of the Auto Scaling Group.
- `max_spot_price` (String) Maximum price to pay for a spot instance in dollars per unit hour.
- `metadata` (Block List) Configuration metadata used when creating the host.<br>*Note: To configure OS disk size OsDiskSize can be specified as Key and its size as value, size value should be atleast 10* (see [below for nested schema](#nestedblock--metadata))
- `min_instance_count` (Number) The minimum size of the Auto Scaling Group.
- `minion_tags` (Block List) A map of tags to assign to the resource. Example - `AllocationTags` can be passed as tag key with any value. (see [below for nested schema](#nestedblock--minion_tags))
- `network_interface` (Block List) An optional list of custom network interface configurations to use when creating the host. (see [below for nested schema](#nestedblock--network_interface))
- `prepend_user_data` (Boolean) Bootstrap an EKS host with Duplo's user data, prepending it to custom user data if also provided. Defaults to `true`.
- `tags` (Block List) (see [below for nested schema](#nestedblock--tags))
- `taints` (Block List, Max: 50) Specify taints to attach to the nodes, to repel other nodes with different toleration (see [below for nested schema](#nestedblock--taints))
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))
- `use_spot_instances` (Boolean) Whether or not to use spot instances. Defaults to `false`.
- `user_account` (String) The name of the tenant that the host will be created in.
- `volume` (Block List) Block to specify additional or secondary volume beyond the root device (see [below for nested schema](#nestedblock--volume))
- `wait_for_capacity` (Boolean) Whether or not to wait until ASG instances to be healthy, after creation. Defaults to `true`.
- `zone` (String, Deprecated) The availability zone to launch the host in, expressed as a number and starting at 0. zone has been deprecated instead use zones
- `zones` (List of Number) The multi availability zone to launch the asg in, expressed as a number and starting at 0 - Zone A 1 - Zone B. For Automatic do not specify zones and zone field

### Read-Only

- `fullname` (String) The full name of the ASG profile.
- `id` (String) The ID of this resource.
- `initial_base64_user_data` (String)
- `public_ip_address` (String) The primary public IP address assigned to the host.

<a id="nestedblock--metadata"></a>
### Nested Schema for `metadata`

Required:

- `key` (String)
- `value` (String)


<a id="nestedblock--minion_tags"></a>
### Nested Schema for `minion_tags`

Required:

- `key` (String)
- `value` (String)


<a id="nestedblock--network_interface"></a>
### Nested Schema for `network_interface`

Optional:

- `associate_public_ip` (Boolean) Whether or not to associate a public IP with the newly created ENI.  Cannot be specified if `network_interface_id` is specified.
- `device_index` (Number) The device index to pass to AWS for attaching the ENI.  Starts at zero.
- `groups` (List of String)
- `metadata` (Block List) (see [below for nested schema](#nestedblock--network_interface--metadata))
- `network_interface_id` (String) The ID of an ENI to attach to this host.  Cannot be specified if `subnet_id` or `associate_public_ip` is specified.
- `subnet_id` (String) The ID of a subnet in which to create a new ENI.  Cannot be specified if `network_interface_id` is specified.

<a id="nestedblock--network_interface--metadata"></a>
### Nested Schema for `network_interface.metadata`

Required:

- `key` (String)
- `value` (String)



<a id="nestedblock--tags"></a>
### Nested Schema for `tags`

Required:

- `key` (String)
- `value` (String)


<a id="nestedblock--taints"></a>
### Nested Schema for `taints`

Required:

- `effect` (String) Update strategy of the node. Effect types <br>      - NoSchedule<br>     - PreferNoSchedule<br>     - NoExecute
- `key` (String)

Optional:

- `value` (String)


<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String)
- `delete` (String)
- `update` (String)


<a id="nestedblock--volume"></a>
### Nested Schema for `volume`

Optional:

- `iops` (Number)
- `name` (String)
- `size` (Number)
- `volume_id` (String)
- `volume_type` (String)

## Import

Import is supported using the following syntax:

```shell
# Example: Importing an existing AWS ASG
#  - *TENANT_ID* is the tenant GUID
#  - *FRIENDLY_NAME* is the duploservices-<account_name>-<friendly_name>
#
terraform import duplocloud_asg_profile.myAsgProfile *TENANT_ID*/*FRIENDLY_NAME*
```
